@page "/races"

@using BlazorTable
@using StartAndPark.Application
@using StartAndPark.Client.Components

@inject NavigationManager _navigationManager

<ManagementListPage TItem="RaceDto"
                    Title="Races"
                    IdField="@(x => x.Id)"
                    NameField="@(x => x.Name)"
                    ManagePath="races"
                    RowClickAction="ShowEntries">

    <Column TableItem="RaceDto" Title="Track" Field="@(x => x.TrackName)" Sortable="true" />

    <Column TableItem="RaceDto" Title="Start Time (Eastern)" Field="@(x => x.StartTime)" Sortable="true" DefaultSortColumn="true" />

    <Column TableItem="RaceDto" Title="Completed" Field="@(x => x.IsComplete)" Width="3%">
        <Template>
            @if (context.IsComplete)
            {
                <span class="oi oi-check" />
            }
        </Template>
    </Column>

</ManagementListPage>

@code {
    private void ShowEntries(RaceDto race)
    {
        if (race == null) return;

        _navigationManager.NavigateTo($"races/{race.Id}/entries");
    }
}
